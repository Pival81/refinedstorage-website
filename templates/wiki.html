{% extends "layout.html" %}

{% block title %}{{ wiki.name }}{% endblock %}

{% block content %}
<h1 class="float-lg-left">{{ wiki.name }}</h1>

<div class="float-lg-right"><a href="/wiki/{{ wiki.url }}/revisions" class="btn btn-secondary"><span class="fa fa-file-o"></span> Revisions</a></div>

{% if user != null %}
  {% if wiki.status == 0 %}
    <div class="float-lg-right" style="margin-right: 10px"><a href="/wiki/{{ wiki.url }}/delete" class="btn btn-secondary"><span class="fa fa-trash-o"></span> Delete</a></div>
  {% elseif wiki.status == 1 %}
    <div class="float-lg-right" style="margin-right: 10px"><a href="/wiki/{{ wiki.url }}/restore" class="btn btn-secondary"><span class="fa fa-history"></span> Restore</a></div>
  {% endif %}
  <div class="float-lg-right" style="margin-right: 10px"><a href="/wiki/{{ wiki.url }}/edit" class="btn btn-secondary"><span class="fa fa-pencil"></span> Edit</a></div>
  {% if old %}
  <div class="float-lg-right" style="margin-right: 10px"><a href="/wiki/{{ wiki.url }}/{{ wiki.revision.id }}/revert" class="btn btn-secondary"><span class="fa fa-pencil"></span> Revert to this version</a></div>
  {% endif %}
{% endif %}

<div class="clearfix"></div>

<ol class="breadcrumb">
  <li class="breadcrumb-item"><a href="/wiki">Wiki</a></li>
  <li class="breadcrumb-item active">{{ wiki.name }}</li>
</ol>

{% if old %}
<div class="alert alert-warning" role="alert">
  <strong>Watching specific revision!</strong> <a href="/wiki/{{ wiki.url }}">Click here</a> to go back to current revision.
</div>
{% endif %}

<div class="row row-offcanvas row-offcanvas-right">
  <div class="col-sm-9">
    <p class="float-xs-right hidden-sm-up">
      <button type="button" class="btn btn-primary btn-sm" data-toggle="offcanvas">Toggle nav</button>
    </p>

    {{ wiki.revision.body|raw }}

    <div class="card card-outline-secondary text-xs">
      <div class="card-block">
        <p {% if wiki.revision.reverted_from == 0 %}style="margin: 0px"{% endif %}>Last edited by {{ wiki.revision.user.username }} at {{ wiki.revision.date|date("m/d/Y H:i:s") }}.</p>
        {% if wiki.revision.reverted_from != 0 %}
          <p style="margin: 0px">Reverted by {{ wiki.revision.revertedBy.username }} from an <a href="/wiki/{{ wiki.url }}/{{ wiki.revision.revertedFrom.id }}">earlier version</a>.</p>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-sm-3 sidebar-offcanvas" id="sidebar">
    <div class="card">
      <div class="card-block">
        {{ sidebar.revision.body|raw }}

        {% if user != null %}
          <a href="/wiki/{{ sidebar.url }}/edit" class="btn btn-secondary btn-sm"><span class="fa fa-pencil"></span> Edit</a>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}